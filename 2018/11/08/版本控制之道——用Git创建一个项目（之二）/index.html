<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>版本控制之道——用Git创建一个项目（之二） | 手心暖手背</title><link rel="stylesheet" type="text/css" href="//fonts.neworld.org/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">版本控制之道——用Git创建一个项目（之二）</h1><a id="logo" href="/.">手心暖手背</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="Arama"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">版本控制之道——用Git创建一个项目（之二）</h1><div class="post-meta"><a href="/2018/11/08/版本控制之道——用Git创建一个项目（之二）/#comments" class="comment-count"></a><p><span class="date">Nov 08, 2018</span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>点击</i></i></span></p></div><div class="post-content"><h4 id="预习：Git设置"><a href="#预习：Git设置" class="headerlink" title="预习：Git设置"></a>预习：Git设置</h4><p>Git需要用户提供若干信息。Git是分布式的，因此不存在向用户询问姓名和邮件地址的中央版本库。通过命令git config，用户可以把此类信息提供给本地版本库。</p>
<p>须要设定一些全局变量的值。“全局”的意思是，你在这台计算机上使用任何Git版本库时，这些全局变量的值都起作用。</p>
<p>user.name（标识修改是谁提交的）和user.email（方便联系修改者） 两个全局变量是必须设置的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ git config --global user.name &quot;Travis Swicegood&quot;</span><br><span class="line">$ git config --global user.email &quot;development@domain51.com&quot;</span><br><span class="line">$ git config --global --list</span><br></pre></td></tr></table></figure>
<p>以上三个命令分别设置user.name和user.email，以及检查确认global设置。</p>
<h4 id="第一节-创建版本库"><a href="#第一节-创建版本库" class="headerlink" title="第一节 创建版本库"></a>第一节 <strong>创建版本库</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir mysite</span><br><span class="line">$ cd mysite</span><br><span class="line">$ git init</span><br></pre></td></tr></table></figure>
<p>创建完成。这个Git版本库就可以用来记录和跟踪该项目的代码了。</p>
<p><strong>git init</strong>命令会创建一个.git目录。这个目录用来存放版本库的全部元数据。mysite目录作为工作目录树，存放从版本库中检出的代码。</p>
<h4 id="第二节-代码修改"><a href="#第二节-代码修改" class="headerlink" title="第二节 代码修改"></a>第二节 代码修改</h4><p>在mysite目录中，创建一个index.html文件，内容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">        &lt;body&gt;</span><br><span class="line">                &lt;h1&gt;hello world!&lt;/h1&gt;</span><br><span class="line">        &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>要想让Git跟踪这个文件，须先让它知道这个文件要分两步走：首先使用<strong>git add</strong>命令把该文件添加到版本库的索引；然后使用<strong>git commit</strong>命令提交。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ git add index.html</span><br><span class="line">$ git commit -m &quot;add in hello world html&quot;</span><br><span class="line">[master (root-commit) 6e71f4e] add in hello world html</span><br><span class="line"> 1 file changed, 6 insertions(+)</span><br><span class="line"> create mode 100644 index.html</span><br></pre></td></tr></table></figure>
<p>查看提交记录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ git log</span><br><span class="line">commit 6e71f4eb68c0b94f65bf3ff9c4fbeafec3bfe9b1 (HEAD -&gt; master)</span><br><span class="line">Author: zhangjie0072 &lt;zhangjie0072@126.com&gt;</span><br><span class="line">Date:   Thu Nov 8 14:16:21 2018 +0800</span><br><span class="line"></span><br><span class="line">    add in hello world html</span><br></pre></td></tr></table></figure>
<p>第一行显示提交名称，该名称是Git自动产生的SHA-1码。Git通过它来追踪提交。Git使用哈希码可以保证每个提交的名称都是独一无二的。这在分布式的环境中非常重要。</p>
<p>可以看到git log输出的提交名称的前七位字符和命令git commit输出的相同。（见以上两段git输出）</p>
<p><em>什么是SHA-1哈希码？Git为什么要用它？</em></p>
<p><em>在集中式版本控制系统中，一台特定的服务器会为每个提交分配一个数字（通常是不断增长的自然数），用这些数字区分不同的提交。对于分布式版本控制系统，这个方法就行不通了。</em></p>
<p><em>当两个人工作在同一套代码上，分别往各自的本地版本库提交时，相同的提交号对应着不同的修改。这样的提交号就不能再唯一标识一个提交了。Git用SHA-1解决了这个问题。</em></p>
<p><em>SHA的意思是安全哈希算法。他由美国国家安全局（NSA）开发，用来从已知的数据中产生一个短的字符串，这个字符串几乎不可能等同于另外一组数据产生的字符串。</em></p>
<p><em>Git使用版本库中的元数据产生提交名称。这些元数据包括提交者的个人信息及提交的时间戳。这些数据产生的哈希码，使不同的提交几乎不可能具有相同的提交名称。</em></p>
<p><em>当然，产生相同哈希码的可能性是存在的，但是这种可能性非常低，可以忽略。从数学角度来讲，这种可能性是2的63次方分之一。</em></p>
<p><em>40位的哈希码很难记，大多数情况下，7位的哈希码就可以基本保证提交名称具有的唯一性。</em></p>
<h4 id="第三节-在项目中工作"><a href="#第三节-在项目中工作" class="headerlink" title="第三节 在项目中工作"></a>第三节 在项目中工作</h4><p>下面把index.html文件内容修改为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">        &lt;head&gt;</span><br><span class="line">                &lt;title&gt;hello world in Git&lt;/title&gt;</span><br><span class="line">        &lt;/head&gt;</span><br><span class="line">        &lt;body&gt;</span><br><span class="line">                &lt;h1&gt;hello world!&lt;/h1&gt;</span><br><span class="line">        &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>修改完毕，用<strong>git status</strong>命令显示工作目录树的状态。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line"></span><br><span class="line">        modified:   index.html</span><br><span class="line"></span><br><span class="line">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span><br></pre></td></tr></table></figure>
<p>Git中有三个地方可以存放代码。</p>
<p>第一个地方是工作目录树，编辑文件时可以直接在这里操作。</p>
<p>第二个是索引，也就是暂存区。暂存区是工作目录树和版本库之间的缓冲区。</p>
<p>第三个，版本库。</p>
<p><strong>git add</strong>命令可以暂存对index.html刚刚做的修改。跟 前面章节中添加一个新文件时使用的是同一个命令，只不过这次他告诉Git要追踪的是一个新的修改而非新的文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ git add index.html</span><br><span class="line">$ git status</span><br><span class="line">On branch master</span><br><span class="line">Changes to be committed:</span><br><span class="line">  (use &quot;git reset HEAD &lt;file&gt;...&quot; to unstage)</span><br><span class="line"></span><br><span class="line">        modified:   index.html</span><br></pre></td></tr></table></figure>
<p>暂存修改过的index.html后，执行命令git status可以看到，输出信息中的标题从Change but not updated变成了Change to be committed。如果打开颜色开关，index.html这一行会由红色变为绿色。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (master)</span><br><span class="line">$ git commit -m &quot;add head and title to index&quot; \</span><br><span class="line">&gt; -m &quot;This allows for a more semantic document&quot;</span><br><span class="line">[master 041a928] add head and title to index</span><br><span class="line"> 1 file changed, 3 insertions(+)</span><br><span class="line"></span><br><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (master)</span><br><span class="line">$ git log -l</span><br><span class="line">fatal: Option &apos;l&apos; requires a value</span><br><span class="line"></span><br><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (master)</span><br><span class="line">$ git log -1</span><br><span class="line">commit 041a928b39d8a8a24ddf0528320547ca961c2006 (HEAD -&gt; master)</span><br><span class="line">Author: zhangjie0072 &lt;zhangjie0072@126.com&gt;</span><br><span class="line">Date:   Thu Nov 8 15:11:36 2018 +0800</span><br><span class="line"></span><br><span class="line">    add head and title to index</span><br><span class="line"></span><br><span class="line">    This allows for a more semantic document</span><br><span class="line"></span><br><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (master)</span><br><span class="line">$ git log -2</span><br><span class="line">commit 041a928b39d8a8a24ddf0528320547ca961c2006 (HEAD -&gt; master)</span><br><span class="line">Author: zhangjie0072 &lt;zhangjie0072@126.com&gt;</span><br><span class="line">Date:   Thu Nov 8 15:11:36 2018 +0800</span><br><span class="line"></span><br><span class="line">    add head and title to index</span><br><span class="line"></span><br><span class="line">    This allows for a more semantic document</span><br><span class="line"></span><br><span class="line">commit 6e71f4eb68c0b94f65bf3ff9c4fbeafec3bfe9b1</span><br><span class="line">Author: zhangjie0072 &lt;zhangjie0072@126.com&gt;</span><br><span class="line">Date:   Thu Nov 8 14:16:21 2018 +0800</span><br><span class="line"></span><br><span class="line">    add in hello world html</span><br></pre></td></tr></table></figure>
<p>git commit 命令不要忘记使用-m参数。在参数后边提交留言。看见上边使用了两个-m参数。Git可以接受输入任意多次提交留言的输入，每次另起一段。如果一行命令输入不完，可用\ 回车来继续输入命令。</p>
<p><strong>git log -1</strong> / git log -2，git log命令加数量参数，可控制显示最近的多少条日志。</p>
<h4 id="第四节-理解并使用分支"><a href="#第四节-理解并使用分支" class="headerlink" title="第四节 理解并使用分支"></a>第四节 理解并使用分支</h4><p>有两种分支比较有用：第一种，用来支持项目的不同发布版本的分支；第二种，用来支持一个特定功能的开发的分支。下面介绍第一种：</p>
<p>譬如mysite项目几乎可以发布了，但还需进行测试等工作，直到确认她达到了预期的功能和质量。与此同时，借助分支，可以开始下一个版本的新功能的开发了。</p>
<p>分支可以为要发布的代码保留一份拷贝，所以无需停止正在开发的工作。</p>
<p>创建分支的命令 <strong>git branch</strong>需要两个参数，新分支名称和父分支名称。新创建的分支基于已经存在的父分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git branch RB_1.0 master</span><br></pre></td></tr></table></figure>
<p>RB标识release branch。</p>
<p>之后把index.html文件内容修改为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">        &lt;head&gt;</span><br><span class="line">                &lt;title&gt;hello world in Git&lt;/title&gt;</span><br><span class="line">        &lt;/head&gt;</span><br><span class="line">        &lt;body&gt;</span><br><span class="line">                &lt;li&gt;&lt;a href=&quot;bio.html&quot;&gt;Biography&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">                &lt;h1&gt;hello world!&lt;/h1&gt;</span><br><span class="line">        &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>用如下命令提交这些修改： <strong>git commit -a</strong></p>
<p>-a参数告诉git提交全部修改过的文件。</p>
<p>但是也要输入提交留言。</p>
<p>现在主分支上有最新的修改，而发布分支上还是原来的代码。用<strong>git checkout</strong>命令切换到发布分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (master)</span><br><span class="line">$ git checkout RB_1.0</span><br><span class="line">Switched to branch &apos;RB_1.0&apos;</span><br><span class="line"></span><br><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (RB_1.0)</span><br><span class="line">$ cat index.html</span><br><span class="line">&lt;html&gt;</span><br><span class="line">        &lt;head&gt;</span><br><span class="line">                &lt;title&gt;hello world in Git&lt;/title&gt;</span><br><span class="line">        &lt;/head&gt;</span><br><span class="line">        &lt;body&gt;</span><br><span class="line">                &lt;h1&gt;hello world!&lt;/h1&gt;</span><br><span class="line">        &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>可以看到切到发布分支了，并且该分支上index.html文件的内容仍是原来的内容。</p>
<p>这时候在发布分支上修改内容为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ cat index.html</span><br><span class="line">&lt;html&gt;</span><br><span class="line">        &lt;head&gt;</span><br><span class="line">                &lt;title&gt;hello world in Git&lt;/title&gt;</span><br><span class="line">                &lt;meta name = &quot;description&quot; content=&quot;hello world in Git&quot;/&gt;</span><br><span class="line">        &lt;/head&gt;</span><br><span class="line">        &lt;body&gt;</span><br><span class="line">                &lt;h1&gt;hello world!&lt;/h1&gt;</span><br><span class="line">        &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">$ git commit -m &quot;can push&quot; -a</span><br></pre></td></tr></table></figure>
<p>顺便说一句，在分支上查看log，也是可以看到从第一期开始的log的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ git log</span><br><span class="line">commit 2f4d16d7370dd81d4a5da7baad4e83a774da11bc (HEAD -&gt; RB_1.0)</span><br><span class="line">Author: zhangjie0072 &lt;zhangjie0072@126.com&gt;</span><br><span class="line">Date:   Thu Nov 8 15:37:29 2018 +0800</span><br><span class="line"></span><br><span class="line">    can push</span><br><span class="line"></span><br><span class="line">commit 041a928b39d8a8a24ddf0528320547ca961c2006</span><br><span class="line">Author: zhangjie0072 &lt;zhangjie0072@126.com&gt;</span><br><span class="line">Date:   Thu Nov 8 15:11:36 2018 +0800</span><br><span class="line"></span><br><span class="line">    add head and title to index</span><br><span class="line"></span><br><span class="line">    This allows for a more semantic document</span><br><span class="line"></span><br><span class="line">commit 6e71f4eb68c0b94f65bf3ff9c4fbeafec3bfe9b1</span><br><span class="line">Author: zhangjie0072 &lt;zhangjie0072@126.com&gt;</span><br><span class="line">Date:   Thu Nov 8 14:16:21 2018 +0800</span><br><span class="line"></span><br><span class="line">    add in hello world html</span><br></pre></td></tr></table></figure>
<h4 id="第五节-处理发布"><a href="#第五节-处理发布" class="headerlink" title="第五节 处理发布"></a>第五节 处理发布</h4><p>1.0版本可以发布了，用Git中的代码打标签。意味着在版本库历史中标记处特定的点（用人类可以理解的名称而非SHA号）。这样将来就容易找到对应版本的代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (RB_1.0)</span><br><span class="line">$ git tag 1.0 RB_1.0</span><br><span class="line"></span><br><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (RB_1.0)</span><br><span class="line">$ git tag</span><br><span class="line">1.0</span><br></pre></td></tr></table></figure>
<p>git tag 标签名称 希望打标签的点。</p>
<p>git tag不加参数，可以查看版本库中的标签列表。此时只有1.0</p>
<p>至此，主分支和发布分支都有各自不同的提交。需要把RB_1.0的修改合并到主分支上来。</p>
<p>变基命令git rebase 可以完成这项工作。变基是把一条分支上的修改在另一条分支的末梢重现。<em>（变基的意思是“改变分支的基底”。不同的版本控制工具，其实现方法不尽相同。假定有分支A和分支B，他们的交叉点是版本Y。Git的实现方式是，如果站在分支B上告诉Git，“我要变基到A的末梢”，那么Git会把从版本Y到分支B的当前末梢之间的所有提交，顺序加到分支A的末梢上去，生成新的分支B及其末梢，而分支A及其末梢则没有任何变化。）</em></p>
<p>首先切回主分支 git checkout master</p>
<p>接着运行命令 git rebase 后边跟参数，希望变基到哪条分支的末梢，就使用哪条分支名称做参数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (RB_1.0)</span><br><span class="line">$ git checkout master</span><br><span class="line">Switched to branch &apos;master&apos;</span><br><span class="line"></span><br><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (master)</span><br><span class="line">$ git rebase RB_1.0</span><br><span class="line">First, rewinding head to replay your work on top of it...</span><br><span class="line">Applying: add url</span><br><span class="line">Using index info to reconstruct a base tree...</span><br><span class="line">M       index.html</span><br><span class="line">Falling back to patching base and 3-way merge...</span><br><span class="line">Auto-merging index.html</span><br><span class="line"></span><br><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (master)</span><br><span class="line">$ cat index.html</span><br><span class="line">&lt;html&gt;</span><br><span class="line">        &lt;head&gt;</span><br><span class="line">                &lt;title&gt;hello world in Git&lt;/title&gt;</span><br><span class="line">                &lt;meta name = &quot;description&quot; content=&quot;hello world in Git&quot;/&gt;</span><br><span class="line">        &lt;/head&gt;</span><br><span class="line">        &lt;body&gt;</span><br><span class="line">                &lt;li&gt;&lt;a href=&quot;bio.html&quot;&gt;Biography&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">                &lt;h1&gt;hello world!&lt;/h1&gt;</span><br><span class="line">        &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (master)</span><br><span class="line">$ git log</span><br><span class="line">commit 665439cb7a91fa7395f771bc387ecd2b49a17c33 (HEAD -&gt; master)</span><br><span class="line">Author: zhangjie0072 &lt;zhangjie0072@126.com&gt;</span><br><span class="line">Date:   Thu Nov 8 15:32:38 2018 +0800</span><br><span class="line"></span><br><span class="line">    add url</span><br><span class="line"></span><br><span class="line">commit 2f4d16d7370dd81d4a5da7baad4e83a774da11bc (tag: 1.0, RB_1.0)</span><br><span class="line">Author: zhangjie0072 &lt;zhangjie0072@126.com&gt;</span><br><span class="line">Date:   Thu Nov 8 15:37:29 2018 +0800</span><br><span class="line"></span><br><span class="line">    can push</span><br><span class="line"></span><br><span class="line">commit 041a928b39d8a8a24ddf0528320547ca961c2006</span><br><span class="line">Author: zhangjie0072 &lt;zhangjie0072@126.com&gt;</span><br><span class="line">Date:   Thu Nov 8 15:11:36 2018 +0800</span><br><span class="line"></span><br><span class="line">    add head and title to index</span><br><span class="line"></span><br><span class="line">    This allows for a more semantic document</span><br><span class="line"></span><br><span class="line">commit 6e71f4eb68c0b94f65bf3ff9c4fbeafec3bfe9b1</span><br><span class="line">Author: zhangjie0072 &lt;zhangjie0072@126.com&gt;</span><br><span class="line">Date:   Thu Nov 8 14:16:21 2018 +0800</span><br><span class="line"></span><br><span class="line">    add in hello world html</span><br></pre></td></tr></table></figure>
<p>此时可以看到，add url结点放入RB_1.0分支最后一个提交的后面。</p>
<p>最后，作为整理工作的一部分，删除发布分支。这样看上去好像很危险，不过不用担心，刚才打过的标签所指向的结点就是RB_1.0分支的末梢。（只要标签还在，从标签到版本树起点的一连串提交记录就在。）这时删除分支只是删除了分支的名字，并不会删除分支上的任何实际内容。</p>
<p>使用命令<strong>git branch -d</strong> 加分支名字可以删除分支。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (master)</span><br><span class="line">$ git branch -d RB_1.0</span><br><span class="line">Deleted branch RB_1.0 (was 2f4d16d).</span><br></pre></td></tr></table></figure>
<p>此时如果想给1.0.x分支打补丁，只需要从打标签的地方再创建一条分支即可。之前的创建分支命令最后一个参数是父分支的名称。现在只需把父分支名称改成发布标签名称即可。命令如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (master)</span><br><span class="line">$ git branch RB_1.0.1 1.0</span><br><span class="line"></span><br><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (master)</span><br><span class="line">$ git checkout RB_1.0.1</span><br><span class="line">Switched to branch &apos;RB_1.0.1&apos;</span><br><span class="line"></span><br><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (RB_1.0.1)</span><br><span class="line">$ git log</span><br><span class="line">commit 2f4d16d7370dd81d4a5da7baad4e83a774da11bc (HEAD -&gt; RB_1.0.1, tag: 1.0)</span><br><span class="line">Author: zhangjie0072 &lt;zhangjie0072@126.com&gt;</span><br><span class="line">Date:   Thu Nov 8 15:37:29 2018 +0800</span><br><span class="line"></span><br><span class="line">    can push</span><br><span class="line"></span><br><span class="line">commit 041a928b39d8a8a24ddf0528320547ca961c2006</span><br><span class="line">Author: zhangjie0072 &lt;zhangjie0072@126.com&gt;</span><br><span class="line">Date:   Thu Nov 8 15:11:36 2018 +0800</span><br><span class="line"></span><br><span class="line">    add head and title to index</span><br><span class="line"></span><br><span class="line">    This allows for a more semantic document</span><br><span class="line"></span><br><span class="line">commit 6e71f4eb68c0b94f65bf3ff9c4fbeafec3bfe9b1</span><br><span class="line">Author: zhangjie0072 &lt;zhangjie0072@126.com&gt;</span><br><span class="line">Date:   Thu Nov 8 14:16:21 2018 +0800</span><br><span class="line"></span><br><span class="line">    add in hello world html</span><br></pre></td></tr></table></figure>
<p>git log快速查看历史记录，可以看到在RB_1.0分支上只有3个提交（而不包括主分支上的最新提交）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ git log --pretty=oneline</span><br><span class="line">2f4d16d7370dd81d4a5da7baad4e83a774da11bc (HEAD -&gt; RB_1.0.1, tag: 1.0) can push</span><br><span class="line">041a928b39d8a8a24ddf0528320547ca961c2006 add head and title to index</span><br><span class="line">6e71f4eb68c0b94f65bf3ff9c4fbeafec3bfe9b1 add in hello world html</span><br></pre></td></tr></table></figure>
<p>使用Git做的最后一件事儿是，为代码发布创建归档文件。没必要总是把历史记录（也就是Git版本库）一起发布，通常情况下，将标签对应的版本内容打包成一个tar包或zip包就足够了。可使用git archive命令来做归档处理。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Orange@DESKTOP-8VK4FUU MINGW64 /d/MyGit/mysite (RB_1.0.1)</span><br><span class="line">$ git archive --format=tar\</span><br><span class="line">&gt; --prefix=mysite-1.0/ 1.0\</span><br><span class="line">&gt; |gzip &gt; mysite-1.0.tar.gz</span><br><span class="line">fatal: Unknown archive format &apos;tar--prefix=mysite-1.0/&apos;</span><br></pre></td></tr></table></figure>
<p>该命令中有三个参数。第一个，–format指明要产生tar格式的输出；第二个，–prefix指明包中所有的东西都放到mysite-1.0/目录下；最后，1.0指明需要归档的标签的名称。</p>
<p>第三行看起来有点复杂，该命令把git archive产生的tar文件用管道输出的方法传递给命令gzip进行压缩，而压缩结果则重定向到mysite-1.0.tar.gz压缩包里。</p>
<p>命令git archive也可以产生zip文件。创建zip文件更简单，因为git archive的输出是已经按zip标准压缩过的。下面这条命令可以生成一个zip文件。</p>
<p>git archive –format=zip\</p>
<p>​           –prefix=mysite-1.0/ 1.0\</p>
<p>​           &gt; mysite-1.0.zip</p>
<h4 id="第六节-克隆远程版本库"><a href="#第六节-克隆远程版本库" class="headerlink" title="第六节 克隆远程版本库"></a>第六节 克隆远程版本库</h4><p>之前所有的讲述都是与本地版本库mysite打交道的命令，但还没涉及远程版本库。Git也可以与远程版本库打交道，以分享本地的工作成果，或者复制其他的版本库到本地。</p>
<p>与远程版本库打交道，首先要用git clone命令克隆远程版本库。克隆版本库会在本地创建远程版本库的完整拷贝。</p>
<p>git clone 有两个参数，第一个，远程版本库的位置，第二个，存放该版本库的本地目录。第二个参数是可选的，但是在本书的例子中已经有了mysite目录，所以必须要提供第二个参数指定远程版本库拷贝的目标目录。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone git://github.com/tswicegoods/mysite.git mysite-remote</span><br></pre></td></tr></table></figure>
<p>第二个参数相当于给仓库重命名了。</p>
<p>第三章完。2018.18:34 </p>
</div><div class="tags"></div><div class="post-share"><div class="bdsharebuttonbox"><span style="float:left;line-height: 28px;height: 28px;font-size:16px;font-weight:blod">分享到：</span><a href="#" data-cmd="more" class="bds_more"></a><a href="#" data-cmd="mshare" title="分享到一键分享" class="bds_mshare"></a><a href="#" data-cmd="fbook" title="分享到Facebook" class="bds_fbook"></a><a href="#" data-cmd="twi" title="分享到Twitter" class="bds_twi"></a><a href="#" data-cmd="linkedin" title="分享到linkedin" class="bds_linkedin"></a><a href="#" data-cmd="youdao" title="分享到有道云笔记" class="bds_youdao"></a><a href="#" data-cmd="evernotecn" title="分享到印象笔记" class="bds_evernotecn"></a><a href="#" data-cmd="weixin" title="分享到微信" class="bds_weixin"></a><a href="#" data-cmd="qzone" title="分享到QQ空间" class="bds_qzone"></a><a href="#" data-cmd="tsina" title="分享到新浪微博" class="bds_tsina"></a></div></div><div class="post-nav"><a href="/2018/11/09/版本控制之道——添加与提交：Git基础（之三）/" class="pre">版本控制之道——添加与提交：Git基础（之三）</a><a href="/2018/11/07/版本控制之道——使用git（之一）/" class="next">版本控制之道——使用git（之一）</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">文章目录</i></div><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#预习：Git设置"><span class="toc-text">预习：Git设置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#第一节-创建版本库"><span class="toc-text">第一节 创建版本库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#第二节-代码修改"><span class="toc-text">第二节 代码修改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#第三节-在项目中工作"><span class="toc-text">第三节 在项目中工作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#第四节-理解并使用分支"><span class="toc-text">第四节 理解并使用分支</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#第五节-处理发布"><span class="toc-text">第五节 处理发布</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#第六节-克隆远程版本库"><span class="toc-text">第六节 克隆远程版本库</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/11/13/版本控制之道——查看Git历史记录（之五）/">版本控制之道——查看Git历史记录（之五）</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/12/版本控制之道——理解和使用分支（之四）/">版本控制之道——理解和使用分支（之四）</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/09/版本控制之道——添加与提交：Git基础（之三）/">版本控制之道——添加与提交：Git基础（之三）</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/08/版本控制之道——用Git创建一个项目（之二）/">版本控制之道——用Git创建一个项目（之二）</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/07/版本控制之道——使用git（之一）/">版本控制之道——使用git（之一）</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/11/06/hello-world/">Hello World</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li></ul></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">Baidu Site Haritası</a> |  <a href="/atom.xml">订阅</a> |  <a href="/about/">关于</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次</p><p><span> Copyright &copy;<a href="/." rel="nofollow">橘子.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.1"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.1" async></script><script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","weixin","tsina","qzone","linkedin","fbook","twi","print","renren","sqq","evernotecn","bdysc","tqq","tqf","bdxc","kaixin001","tieba","douban","bdhome","thx","ibaidu","meilishuo","mogujie","diandian","huaban","duitang","hx","fx","youdao","sdo","qingbiji","people","xinhua","mail","isohu","yaolan","wealink","ty","iguba","h163","copy"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":{},"image":{"viewList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"]}};with(document)0[(getElementsByTagName('head')[0]||head).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script></body></html>